# Chapter 7 函数

## 7.1 函数定义

## 7.2 函数声明

如果没有关于调用函数的特定信息，编译器便假定在这个函数的调用时参数的类型和数量是正确的。它同时会假定函数返回一个整型值。对于那些返回值并非整型的函数而言，这种隐式认定常常导致错误。

### 7.2.1 原型

函数原型(function prototype)，使用原型最方便（最安全）的方法就是把原型置于一个单独的文件。

### 7.2.2 函数的缺省认定

当程序调用一个无法看到原型的函数时，编译器便认为该函数返回一个整型值。

## 7.3 函数的参数

C函数的所有参数均以“传值调用”方式进行传递，这意味着函数将获得参数值的一份拷贝。

## 7.4 ADT和黑盒

抽象数据类型(ADT, abstract data type)

## 7.5 递归

### 7.5.1 追踪递归函数

以前调用的函数的变量仍保留在堆栈上，但它们被新函数的变量所掩盖，因此是不能被访问的。

### 7.5.2 递归与迭代

## 7.6 可变参数列表

### 7.6.1 `stdarg` 宏

可变参数列表是通过宏来实现的，这些宏定义于 `stdarg.h` 头文件。这个头文件声明了一个类型 `va_list` 和三个宏—— `va_start` `va_arg` 和 `va_end` 。

函数声明了一个叫 `var_arg` 的变量，它用于访问参数列表的未确定部分。通过调用 `va_start` 来初始化。它的第一个参数是 `va_list` 变量的名字，第二个参数是省略号前最后一个有名字的参数。初始化过程把 `var_arg` 变量设置为一个指向可变参数部分的第一个参数。

为了访问参数，需要使用 `va_arg` ,这个宏接受两个参数： `va_list` 变量和参数列表中下一个参数的类型。最后，当访问完毕最后一个可变参量之后，我们需要调用 `va_end` 。

### 7.6.2 可变参数的限制

可变参数必须从头到尾按照顺序逐个访问。如果想一开始就访问参数列表中间的参数，那是不行的。

``` c
/*
** 计算指定数量的值的平均值
*/
#include <stdio.h>

float average(int n_values, ...)
{
    va_list var_arg;
    int count;
    float sum = 0;
    /*准备访问可变参数*/
    va_start(var_arg, n_values);
    /*添加取自可变参数列表的值*/
    for (count = 0; count < n_value; counnt++)
    {
        sum += va_arg(var_arg, int);
    }
    /*完成处理可变参数*/
    va_end(var_arg);

    return sum / n_values;
}
```